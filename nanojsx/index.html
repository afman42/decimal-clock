<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Decimal Clock</title>
	<link rel="stylesheet" type="text/css" href="./style.css">
	<script src="https://unpkg.com/nano-jsx/bundles/nano.full.min.js"></script>
	<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body>
<div id="root"></div>
<script type="text/jsx">
	const { jsx, render,h, Component,Fragment } = nanoJSX	
	class ClockFace extends Component {
	  render() {
	        // console.log(this.props)
	    return (
	      <div id="clock-face">
	        {[...Array(10)].map((_, i) => (
	          <div
	            key={i}
	            class="digit"
	            style={{
	              left: 50 - Math.sin((Math.PI * i) / 5) * 40 + "%",
	              top: 50 + Math.cos((Math.PI * i) / 5) * 40 + "%",
	            }}
	          >
	            {i}
	          </div>
	        ))}

	        {[...Array(100)].map((_, i) => (
	          <div
	            key={i}
	            class={i % 10 === 0 ? "large tick" : "tick"}
	            style={{ transform: `rotate(${i * 3.6}deg)` }}
	          />
	        ))}

	        {this.props.fractionOfDay && (
	          <>
	            <div
	              id="short-hand"
	              style={{
	                transform: `rotate(${this.props.fractionOfDay * 360 + 180}deg)`,
	              }}
	            />

	            <div
	              id="long-hand"
	              style={{
	                transform: `rotate(${
	                  ((this.props.fractionOfDay * 10) % 1) * 360 + 180
	                }deg)`,
	              }}
	            />

	            <div
	              id="second-hand"
	              style={{
	                transform: `rotate(${
	                  ((this.props.fractionOfDay * 1000) % 1) * 360 + 180
	                }deg)`,
	              }}
	            />
	          </>
	        )}
	      </div>
	    );
	  }
	}

	class ClockTime extends Component {
	  render() {
	    const hh = Math.floor(this.props.fractionOfDay * 10);
	    const mm = Math.floor((this.props.fractionOfDay * 10 - hh) * 100);
	    const ss = Math.floor((this.props.fractionOfDay * 100000) % 100);

	    const timeString = `${hh}:${mm.toString().padStart(2, "0")}:${ss
	      .toString()
	      .padStart(2, "0")}`;

	    return <h1 id="clock-time">{timeString}</h1>;
	  }
	}


	class DecimalClock extends Component {

	  requestRef

	  constructor(props) {
	    super(props);

	    this.state = {
	      date: new Date(),
	    };

	    this.updates = this.updates.bind(this);
	  }

	  updates() {
	    this.setState({
	      date: new Date(),
	    });
	    this.update()
	    this.requestRef.current = window.requestAnimationFrame(this.updates);
	  }

	  didMount() {
	    this.requestRef.current = window.requestAnimationFrame(this.updates);
	    console.log('aa')
	  }

	  didUnmount() {
	    cancelAnimationFrame(this.requestRef.current);
	  }

	  render() {
	    const { date } = this.state;
	    // const { date } = pro
	    const timeOfDay =
	      date.getHours() * 60 * 60 * 1000 +
	      date.getMinutes() * 60 * 1000 +
	      date.getSeconds() * 1000 +
	      date.getMilliseconds();

	    const fractionOfDay = timeOfDay / 86400000;
	    //this.didMount()
	    // console.log(this.state)
	    return (
	      <Fragment>
	        <h2>Decimal Clock</h2>
	        <ClockFace fractionOfDay={fractionOfDay} />
	        <ClockTime fractionOfDay={fractionOfDay} />
	      </Fragment>
	    );
	  }
	}

	render(jsx`<${DecimalClock} />`, document.getElementById('root'))
</script>
</body>
</html>